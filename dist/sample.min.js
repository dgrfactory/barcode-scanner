/*! barcode-scanner v1.0.1 | dgrfactory | license: MIT */!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}({2:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{d(o.next(e))}catch(e){r(e)}}function c(e){try{d(o.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}d((o=o.apply(e,t||[])).next())}))};window.addEventListener("load",()=>{var e,t;const n=document.querySelector("span"),i=document.querySelector("video"),r=document.querySelector("canvas"),a=document.querySelector("select[name=direction]"),c=document.querySelector("div.laser"),d=document.querySelector("label.code");let s=0,l=0;const u=()=>{let e=new Worker("worker.min.js?_="+(new Date).getTime());return e.addEventListener("message",e=>{const t=e.data.msg,n=e.data.index;"found"===t&&(window.clearTimeout(l),d.textContent=[`[${e.data.resolved.type}]${e.data.resolved.description}`,`TEXT:${e.data.resolved.text}`,`CODE:${e.data.resolved.code}`].join("\r\n"),c.classList.add("found"),l=window.setTimeout(()=>c.classList.remove("found"),500)),v[n].active=!1}),e},v=[];(()=>{for(let e=0;e<8;e++)v.push({worker:u(),index:e,active:!1})})();const f=e=>o(void 0,void 0,void 0,(function*(){return new Promise((t,n)=>{var o;(null===(o=navigator.mediaDevices)||void 0===o?void 0:o.getUserMedia)?navigator.mediaDevices.getUserMedia(e).then(e=>{setTimeout(()=>t(e),0)}).catch(e=>{n(e)}):navigator.getUserMedia?navigator.getUserMedia(e,e=>{setTimeout(()=>t(e),0)},e=>{n(e)}):n("UserMedia API is not found.")})})),h=()=>{const e=v.filter(e=>!e.active);if(!e.length)return;const t=r.getContext("2d");if(!t)return;const o=r.clientWidth,a=r.clientHeight,d=i.videoWidth,s=i.videoHeight,l=i.clientWidth,u=i.clientHeight;if(r.width=o,r.height=a,n.style.width=l+"px",n.style.height=u+"px",o>=a){const e=Math.max(Math.floor((u-a)/2),0);c.style.top=e+"px",c.style.height=a+"px",c.style.left=c.style.width="",c.style.display="block";const n=Math.max(Math.floor((s-a)/2),0);t.drawImage(i,0,n,d,a,0,0,o,a)}else{const e=Math.max(Math.floor((l-o)/2),0);c.style.left=e+"px",c.style.width=o+"px",c.style.top=c.style.height="",c.style.display="block";const n=Math.max(Math.floor((d-o)/2),0);t.drawImage(i,n,0,o,s,0,0,o,a)}const f={};Array.prototype.slice.call(document.querySelectorAll('input[name="barcode-type"]')).forEach(e=>{f[e.value]=e.checked});const h={minSize:document.querySelector('input[name="min-size"]').value},y={width:o,height:a},m=t.getImageData(0,0,o,a),p=new Uint8ClampedArray(m.data),g=e[0];g.worker.postMessage({imageData:p,size:y,index:g.index,scanTypes:f,options:h}),g.active=!0};a.addEventListener("change",()=>{const e=a.value;r.classList.remove("horizontal","vertical"),r.classList.add(e),c.classList.remove("horizontal","vertical"),c.classList.add(e)}),a.dispatchEvent(new Event("change")),null===(e=document.getElementById("on-button"))||void 0===e||e.addEventListener("click",()=>{o(void 0,void 0,void 0,(function*(){try{const e={video:{facingMode:{exact:"environment"}},audio:!1},t=yield f(e);i.srcObject=t}catch(e){const t={video:{facingMode:"user"},audio:!1},n=yield f(t);i.srcObject=n}s=window.setInterval(h,16)})).catch(e=>console.log(e))}),null===(t=document.getElementById("off-button"))||void 0===t||t.addEventListener("click",()=>{window.clearInterval(s),i.srcObject instanceof MediaStream&&i.srcObject.getTracks().forEach(e=>e.stop()),c.style.display="none"})})}});